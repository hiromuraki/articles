### ğŸ¤– Assistant



### **ä½¿ç”¨ SSH + å…¬é’¥è®¤è¯è¿œç¨‹è¿æ¥ï¼ˆå…å¯†ç ç™»å½•ï¼‰**

SSH å…¬é’¥è®¤è¯æ¯”å¯†ç ç™»å½•æ›´å®‰å…¨ï¼Œé€‚åˆè¿œç¨‹ç®¡ç†æœåŠ¡å™¨ã€è‡ªåŠ¨åŒ–è„šæœ¬ç­‰åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æ­¥éª¤ï¼š

---

## **1. æœ¬åœ°ç”Ÿæˆ SSH å¯†é’¥å¯¹**
åœ¨ **æœ¬åœ°æœºå™¨**ï¼ˆä½ çš„ç”µè„‘ï¼‰ä¸Šç”Ÿæˆå…¬é’¥ï¼ˆ`id_rsa.pub`ï¼‰å’Œç§é’¥ï¼ˆ`id_rsa`ï¼‰ï¼š
```bash
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
```
- `-t rsa`ï¼šä½¿ç”¨ RSA åŠ å¯†ç®—æ³•ï¼ˆæ¨èï¼‰ã€‚
- `-b 4096`ï¼šå¯†é’¥é•¿åº¦ï¼ˆ2048 æˆ– 4096ï¼Œè¶Šé•¿è¶Šå®‰å…¨ï¼‰ã€‚
- `-C "æ³¨é‡Š"`ï¼šå¯é€‰ï¼Œç”¨äºæ ‡è¯†å¯†é’¥ï¼ˆé€šå¸¸ç”¨é‚®ç®±ï¼‰ã€‚

**æŒ‰æç¤ºæ“ä½œï¼š**
1. é»˜è®¤ä¿å­˜è·¯å¾„ï¼š`~/.ssh/id_rsa`ï¼ˆç›´æ¥å›è½¦ï¼‰ã€‚
2. è®¾ç½®å¯†ç ï¼ˆå¯é€‰ï¼Œå¢å¼ºå®‰å…¨æ€§ï¼Œä½†å¯ç•™ç©ºç›´æ¥å›è½¦ï¼‰ã€‚

**ç”Ÿæˆçš„æ–‡ä»¶ï¼š**
- `~/.ssh/id_rsa` â†’ **ç§é’¥**ï¼ˆä¿å¯†ï¼Œä¸è¦æ³„éœ²ï¼ï¼‰
- `~/.ssh/id_rsa.pub` â†’ **å…¬é’¥**ï¼ˆéœ€ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼‰

---

## **2. ä¸Šä¼ å…¬é’¥åˆ°è¿œç¨‹æœåŠ¡å™¨**
### **æ–¹æ³• 1ï¼šä½¿ç”¨ `ssh-copy-id`ï¼ˆæ¨èï¼‰**
```bash
ssh-copy-id -i ~/.ssh/id_rsa.pub username@remote_server_ip
```
- è¾“å…¥æœåŠ¡å™¨å¯†ç åï¼Œå…¬é’¥ä¼šè‡ªåŠ¨æ·»åŠ åˆ° `~/.ssh/authorized_keys`ã€‚

### **æ–¹æ³• 2ï¼šæ‰‹åŠ¨å¤åˆ¶ï¼ˆé€‚ç”¨äºæ—  `ssh-copy-id`ï¼‰**
1. æŸ¥çœ‹æœ¬åœ°å…¬é’¥ï¼š
   ```bash
   cat ~/.ssh/id_rsa.pub
   ```
2. **ç™»å½•è¿œç¨‹æœåŠ¡å™¨**ï¼Œå°†å…¬é’¥ç²˜è´´åˆ° `~/.ssh/authorized_keys`ï¼š
   ```bash
   mkdir -p ~/.ssh  # å¦‚æœç›®å½•ä¸å­˜åœ¨
   echo "ä½ çš„å…¬é’¥å†…å®¹" >> ~/.ssh/authorized_keys
   chmod 600 ~/.ssh/authorized_keys  # è®¾ç½®æƒé™
   ```

---

## **3. æµ‹è¯• SSH å…¬é’¥ç™»å½•**
```bash
ssh username@remote_server_ip
```
- å¦‚æœè®¾ç½®äº†ç§é’¥å¯†ç ï¼Œéœ€è¾“å…¥å¯†ç ã€‚
- å¦‚æœæœªè®¾ç½®å¯†ç ï¼Œç›´æ¥ç™»å½•æˆåŠŸã€‚

---

## **4. ç¦ç”¨å¯†ç ç™»å½•ï¼ˆå¯é€‰ï¼Œå¢å¼ºå®‰å…¨ï¼‰**
ç¼–è¾‘è¿œç¨‹æœåŠ¡å™¨çš„ SSH é…ç½®æ–‡ä»¶ï¼š
```bash
sudo nano /etc/ssh/sshd_config
```
ä¿®æ”¹ä»¥ä¸‹é€‰é¡¹ï¼š
```ini
PasswordAuthentication no  # ç¦ç”¨å¯†ç ç™»å½•
PubkeyAuthentication yes   # å¯ç”¨å…¬é’¥è®¤è¯
```
é‡å¯ SSH æœåŠ¡ï¼š
```bash
sudo systemctl restart sshd
```
**âš ï¸ æ³¨æ„ï¼š** ç¡®ä¿å…¬é’¥å·²ç”Ÿæ•ˆï¼Œå¦åˆ™å¯èƒ½è¢«é”åœ¨æœåŠ¡å™¨å¤–ï¼

---

## **5. é«˜çº§ç”¨æ³•**
### **ï¼ˆ1ï¼‰æŒ‡å®šç§é’¥è¿æ¥**
å¦‚æœç§é’¥ä¸æ˜¯é»˜è®¤çš„ `id_rsa`ï¼Œå¯ç”¨ `-i` æŒ‡å®šï¼š
```bash
ssh -i ~/.ssh/custom_key username@remote_server_ip
```

### **ï¼ˆ2ï¼‰é€šè¿‡ SSH æ‰§è¡Œè¿œç¨‹å‘½ä»¤**
```bash
ssh username@remote_server_ip "ls -l /tmp"
```

### **ï¼ˆ3ï¼‰SSH é…ç½®æ–‡ä»¶ç®€åŒ–è¿æ¥**
åœ¨æœ¬åœ° `~/.ssh/config` æ·»åŠ ï¼š
```ini
Host myserver
    HostName remote_server_ip
    User username
    IdentityFile ~/.ssh/id_rsa
```
ä¹‹ååªéœ€è¾“å…¥ï¼š
```bash
ssh myserver
```

---

## **6. æ’é”™**
- **æƒé™é—®é¢˜**ï¼š
  ```bash
  chmod 700 ~/.ssh
  chmod 600 ~/.ssh/authorized_keys
  ```
- **æŸ¥çœ‹ SSH ç™»å½•æ—¥å¿—**ï¼š
  ```bash
  tail -f /var/log/auth.log  # Ubuntu/Debian
  tail -f /var/log/secure   # CentOS/RHEL
  ```
- **è°ƒè¯•æ¨¡å¼**ï¼š
  ```bash
  ssh -vvv username@remote_server_ip
  ```

---

## **æ€»ç»“**
| æ­¥éª¤ | å‘½ä»¤/æ“ä½œ |
|------|----------|
| 1. ç”Ÿæˆå¯†é’¥å¯¹ | `ssh-keygen -t rsa -b 4096` |
| 2. ä¸Šä¼ å…¬é’¥ | `ssh-copy-id username@server_ip` |
| 3. æµ‹è¯•ç™»å½• | `ssh username@server_ip` |
| 4. ç¦ç”¨å¯†ç ï¼ˆå¯é€‰ï¼‰ | ä¿®æ”¹ `/etc/ssh/sshd_config` |
| 5. é«˜çº§é…ç½® | `~/.ssh/config` æˆ– `ssh -i key` |

ç°åœ¨ä½ å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ SSH å…¬é’¥ç™»å½•äº†ï¼ ğŸ”‘

