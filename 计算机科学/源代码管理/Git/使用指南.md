# Git 使用指南

[TOC]

## 1. 关联到远程库

**（a）关联到空远程存储库**：

```bash
# 关联远程库
git remote add origin "https://github.com/HiroMuraki/g1_urp"

# 推送
git push
```

**（b）关联到非空远程存储库**：

```bash
# 关联远程库
git remote add origin "https://github.com/HiroMuraki/g1_urp"

# 设置上游分支
git push --set-upstream origin main

# 处理分叉（Divergent Branches）
## 方式1：使用merge策略（保留所有提交历史）
git config pull.rebase false
git pull --no-rebase
## 方式2：使用rebase策略（重写本地提交历史）
git config pull.rebase true
git pull --rebase
## 方式3：只允许快进合并（如果存在分叉则拒绝）
git config pull.ff only
git pull --ff-only

git pull origin main --allow-unrelated-histories

# 推送
git push
```

> 如果不在乎远程仓库现有的内容，可以直接使用 `git push -f` 强制推送。

## 2. 多远程仓库推送

### 2.1. 同时推送

如果希望一次 `git push` 同时推送到多个仓库，可以将它们添加到同一远程仓库名（Remote Name）。设置推送目标（GitHub + Gitea）

```bash
git remote set-url --add --push origin git@github.com:name/repo.git
git remote set-url --add --push origin ssh://git@host:port/name/repo.git
```

> 如果误操作，可使用 `git remote set-url --delete --push origin $url` 移除

验证配置

```bash
git remote -v
```

推送

```bash
git branch -M main
git push -u origin main
```

### 2.2. 独立推送

如果希望按需选择推送到 GitHub 还是 Gitea，而不是每次都捆绑推送，可以为它们分别设置不同的远程仓库别名（Remote Name）。 添加独立的远程仓库

```bash
# 添加 GitHub 仓库，命名为 github
git remote add github git@github.com:name/repo.git

# 添加 Gitea 仓库，命名为 gitea
git remote add gitea ssh://git@host:port/name/repo.git
```

> 如果之前已经存在名为 origin 的仓库，你想把它改名以便区分，可以使用 `git remote rename origin github`。要删除某个不需要的别名，可以使用 `git remote remove $name`。

验证配置

```bash
git remote -v
```

在推送时，只需显式指定对应的远程仓库别名即可实现按需推送：

```bash
# 仅推送到 GitHub
git push github main

# 仅推送到 Gitea
git push gitea main
```